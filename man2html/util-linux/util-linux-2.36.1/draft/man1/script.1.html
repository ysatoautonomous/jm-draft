<HTML>
  <HEAD>
  <META CHARSET="UTF-8"/>
  <META HTTP-QUIV="Content-Type" CONTENT="text/html; charset=UTF-8"/>
  <LINK REL="stylesheet" TYPE="text/css"
	    HREF="../../../../css/jm-draft.css"/>
  <TITLE>Manpage of SCRIPT</TITLE>
</HEAD><BODY>
<H1>SCRIPT</H1>
Section: User Commands (1)<BR>Updated: June 2014<BR><A HREF="#index">Index</A>
<A HREF="https://github.com/ysatoautonomous/jm-draft/wiki">Return to Main Contents</A><HR>


<A NAME="lbAB">&nbsp;</A>
<H2>名前</H2>


script - 端末セッションの写し (typescript) を作成する。

<A NAME="lbAC">&nbsp;</A>
<H2>書式</H2>

<B>script</B>

[options]
[<I>file</I>]


<A NAME="lbAD">&nbsp;</A>
<H2>説明</H2>








<B>script</B>

は端末のセッションのすべての写し (typescript) を作成する。
端末のデータは、ログファイルに生の形式で格納され、
タイミングは、(オプションで) 別の構造化されたログファイルに格納される。
タイミングのログは、後で
<B><A HREF="../man1/scriptreplay.1.html">scriptreplay</A></B>(1)

でセッションを再生するのに必要であり、
セッションについての追加の情報を格納している。







バージョン 2.35 以降で、
<B>script</B>

は複数ストリームをサポートし、入力と出力を別のファイルに記録することも、
1 つのファイルに記録することもできる。
このバージョンでは、追加の情報を記録する新しいタイミングファイルも
サポートしている。
コマンド
<B>scriptreplay --summary</B>

で、すべての情報が提供される。
<P>
<P>







引き数
<I>file</I>

または、オプション <B>--log-out</B> <I>file</I> が指定されると、
<B>script</B>

はすべての記録を
<I>file</I>

に保存する。


ファイル名が与えられなければ、写しは
<I>typescript</I>

というファイルに保存される。
<P>






<B>--log-in</B> または <B>--log-io</B> を使った入力の記録では、
端末の echo フラグ設定に拘わらず、
ログファイルはすべての端末セッションの入力 (例えば、パスワード) を含むので、
セキュリティ上のセンシティブな情報も記録される点に注意すること。

<A NAME="lbAE">&nbsp;</A>
<H2>オプション</H2>





<I>size</I> 引き数の後ろに倍数の拡張子
KiB (=1024), MiB (=1024*1024), GiB, TiB, PiB, EiB, ZiB, YiB を
付けることができる
(&quot;iB&quot; はオプションであり、つまり &quot;K&quot; は &quot;KiB&quot; と同じ意味である)。
また、拡張子
KB (=1000), MB (=1000*1000), GB, TB, PB, EB, ZB, YB
を付けることもできる。
<DL COMPACT>
<DT><B>-a</B>, <B>--append</B><DD>





出力を
<I>file</I>

または
<I>typescript</I>

に追加 (append) する。
以前の内容が保存される。
<DT><B>-c</B>, <B>--command</B> <I>command</I><DD>





インタラクティブなシェルではなく、
<I>command</I>

を実行する。
標準出力が端末 (tty) でないと動作が変わってしまうプログラムの出力を、
script が簡単に記録できるようにする。
<DT><B>-E</B>, <B>--echo</B> <I>when</I><DD>

このオプションは、セッションの擬似端末の ECHO フラグを制御する。





サポートされるモードは
<I>always</I>,

<I>never</I>,

<I>auto</I>

である。








デフォルトは
<I>auto</I>

であり -- この場合、現在の標準入力が端末であれば、
二重のエコーを避けるため、ECHO は無効化される。
また、標準入力が端末でない場合 (例えばパイプ
<B>echo date | script</B>

の場合)、セッションログの入力の喪失を避けるため、ECHO は有効化される。
<DT><B>-e</B>, <B>--return</B><DD>




子プロセスの終了コードを返す。
bash でのシグナル終了と同じ形式である (つまり、終了コードは 128+シグナル番号になる)。
子プロセスの終了コードは、常に typescript ファイルに格納される。
<DT><B>-f</B>, <B>--flush</B><DD>





書き込みをするごとに出力をフラッシュする。
これは遠隔で共同作業をする場合に良い。
一方の人が `mkfifo foo; script -f foo' を実行した場合、
もう一方の人は、`cat foo' を使うことにより、
何が実行されているかをリアルタイムで監視することができる。
フラッシュは性能に影響がある点に注意すること。
SIGUSR1 を使って、要求に応じてログをフラッシュできる。
<DT><B>--force</B><DD>



<I>typescript</I>

ファイルがハードリンクやシンボリックリンクであっても、
デフォルトの出力ファイルを許可する。
コマンドはシンボリックリンクを辿る。
<DT><B>-B</B>, <B>--log-io</B> <I>file</I><DD>




入力と出力を同じ <I>file</I> に記録する。
このオプションは、<B>--log-timing</B> も指定された場合にのみ、意味を持つ点に注意すること。
指定されない場合、出力と入力ストリームをログ <I>file</I> から分離することはできない。
<DT><B>-I</B>, <B>--log-in</B> <I>file</I><DD>


入力を <I>file</I> に記録する。
<B>--log-in</B> しか指定されない場合、出力は記録されない。
<P>


このログ記録機能は、端末の echo フラグを無効化している場合の入力
(例えば、パスワード入力) を含む、すべての入力を記録するので、注意して使うこと 。
<DT><B>-O</B>, <B>--log-out</B> <I>file</I><DD>





出力を <I>file</I> に記録する。
オプション <B>--log-out</B> または <B>--log-in</B> が指定されない場合、
デフォルトでは出力はファイル
<I>typescript</I>

に記録される。
<B>--log-in</B> しか指定されない場合、出力は記録されない。
<DT><B>-T</B>, <B>--log-timing</B> <I>file</I><DD>




タイミング情報を <I>file</I> に記録する。
現在のところ、2 種類のタイミングファイルの形式がサポートされている。
1 つのストリーム (入力または出力) の記録が有効にされている場合に、
昔からの (classic) 形式が使われる。
<B>--log-io</B> が使われた場合、
または、<B>--log-in</B> と <B>--log-out</B> の両方が使われた場合、
複数ストリーム (multi-stream) 形式が使われる。

<B>--logging-format</B> も参照すること。
<DT><B>-m</B>, <B>--logging-format</B> <I>format</I><DD>






<I>advanced</I>

または
<I>classic</I>

形式の使用を強制する。
デフォルトは昔からの (classic) 形式であり、出力のみを記録する。
拡張 (advanced) 形式は、出力だけでなく、入力の記録も要求された場合に、使われる。
<P>
<DL COMPACT><DT><DD>

<B>昔からの (classic) 形式</B>

<P>




このログは、空白で区切られた 2 つのフィールドから構成される。
1 つ目のフィールドは、前の出力からの経過時間である。
2 つ目のフィールドは、そのタイミングで何文字出力されたかを示す。
<P>

<B>拡張 (advanced) (複数ストリーム) 形式</B>

<P>





1 つ目のフィールドは、エントリータイプの識別子
('I'nput, 'O'utput, 'H'eader, 'S'ignal) である。
2 つ目のフィールドは、前のエントリからの経過時間であり、
エントリの残りの部分は、タイプ固有のデータである。
</DL>

<DT><B>-o</B>, <B>--output-limit</B> <I>size</I><DD>







typescript のサイズを制限し、ファイルを
<I>size</I>

に切り詰めて、サイズを超過した場合に子プロセスを停止する。
計算されるファイルサイズには、
<B>script</B>

コマンドが子プロセスの出力の前に付ける開始メッセージと、
後に付ける終了メッセージが含まれない。
バッファリングのために、結果の出力ファイルは指定した値より
大きくなる可能性がある。
<DT><B>-q</B>, <B>--quiet</B><DD>

寡黙な動作にする (開始と終了メッセージを標準出力に書き出さない)。
<DT><B>-t</B>[<I>file</I>], <B>--timing</B>[=<I>file</I>]<DD>




タイミングデータを標準エラーに出力する。
<I>file</I>

が指定された場合は、ファイルに出力する。


このオプションは古く、<I>file</I> 引き数がオプションでない、
<B>--log-timing</B> を使うべきである。
<DT><B>-V</B>, <B>--version</B><DD>

バージョン情報を表示して、終了する。
<DT><B>-h</B>, <B>--help</B><DD>

ヘルプを表示して、終了する。

</DL>
<A NAME="lbAF">&nbsp;</A>
<H2>シグナル</H2>





<B>SIGUSR1</B>

を受けると、
<B>script</B>

は出力ファイルを即時にフラッシュする。

<A NAME="lbAG">&nbsp;</A>
<H2>環境変数</H2>



<B>script</B>

は以下の環境変数を用いる。
<DL COMPACT>
<DT><B>SHELL</B>

<DD>








環境変数
<B>SHELL</B>

が定義されていると、
<B>script</B>

が fork するシェルはそれになる。
<B>SHELL</B>

が定義されていなければ、
Bourne シェルが用いられる。
(ほとんどのシェルはこの環境変数を自動的にセットする。)

</DL>
<A NAME="lbAH">&nbsp;</A>
<H2>注意</H2>















script は fork されたシェルが終了したときに記録を終える
(Bourne シェル
(<B><A HREF="../man1p/sh.1p.html">sh</A></B>(1p))

を終わるには
<I>control-D</I>

を入力する。
C シェル
(<B><A HREF="../man1/csh.1.html">csh</A></B>(1))

なら
<I>exit</I>,

<I>logout</I>,

<I>control-d</I>

のいずれかを入力する。
ただし
<I>control-d</I>

が有効なのは
<I>ignoreeof</I>

がセットされていない場合である)。
<P>







<B><A HREF="../man1/vi.1.html">vi</A></B>(1)

のようなインタラクティブなコマンドでは、
typescript ファイルにゴミができることがある。
<B>script</B>

は画面を操作しないコマンドを扱ったときに最もうまく動作する。
その場合の結果は、ハードコピー端末をエミュレートしたものとなる。
<P>










<B>script</B>

を対話的でないシェルで実行するのは推奨されない。
<B>script</B>

の内部シェルは、常に対話的であり、シェルが対話的でない場合、
予期しない結果になる可能性がある。
<B>script</B>

をシェルの初期化ファイルで使う場合、無限ループに入るのを
避けなければならない。
例として、以下の <B>.profile</B> ファイルを使うことができる。
これは、ログインシェルからのみ読み込まれる。
<P>

<DL COMPACT><DT><DD>
<PRE>
if test -t 0 ; then
    script
    exit
fi
</PRE>

</DL>


<P>






<B>script</B>

はあなたが思うより多くの入力を読み込む可能性があるので、
コマンドのパイプから
<B>script</B>

を使うことも避けるべきである。
<P>


<A NAME="lbAI">&nbsp;</A>
<H2>履歴</H2>




<B>script</B>

コマンドは 3.0BSD で登場した。

<A NAME="lbAJ">&nbsp;</A>
<H2>バグ</H2>






<B>script</B>

はラインフィードやバックスペースも含め、
<I>すべて</I>

をログファイルに書きこむ。
これは普通のユーザが期待するものとは異なるかもしれない。
<P>







<B>script</B>

は元々対話的な端末のセッションのために設計されている。
標準入力が端末でない場合 (例えば、<B>echo foo | script</B>)、
セッションがハングする可能性がある。
これは、script セッション内の対話シェルが EOF を見つけられず、
<B>script</B>

がセッションをクローズする手がかりがないためである。
より詳細な情報は「<B>注意</B>」のセクションを参照すること。

<A NAME="lbAK">&nbsp;</A>
<H2>関連項目</H2>

<B><A HREF="../man1/csh.1.html">csh</A></B>(1)




(<I>history</I>

メカニズムに関する部分),
<B><A HREF="../man1/scriptreplay.1.html">scriptreplay</A></B>(1),

<B><A HREF="../man1/scriptlive.1.html">scriptlive</A></B>(1),


<A NAME="lbAL">&nbsp;</A>
<H2>入手方法</H2>





script コマンドは、util-linux パッケージの一部であり、

Linux Kernel Archive

から入手できる。
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">名前</A><DD>
<DT><A HREF="#lbAC">書式</A><DD>
<DT><A HREF="#lbAD">説明</A><DD>
<DT><A HREF="#lbAE">オプション</A><DD>
<DT><A HREF="#lbAF">シグナル</A><DD>
<DT><A HREF="#lbAG">環境変数</A><DD>
<DT><A HREF="#lbAH">注意</A><DD>
<DT><A HREF="#lbAI">履歴</A><DD>
<DT><A HREF="#lbAJ">バグ</A><DD>
<DT><A HREF="#lbAK">関連項目</A><DD>
<DT><A HREF="#lbAL">入手方法</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 14:04:02 GMT, January 22, 2021
</BODY>
</HTML>

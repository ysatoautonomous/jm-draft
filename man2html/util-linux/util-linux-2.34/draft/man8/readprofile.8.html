<HTML>
  <HEAD>
  <META CHARSET="UTF-8"/>
  <META HTTP-QUIV="Content-Type" CONTENT="text/html; charset=UTF-8"/>
  <LINK REL="stylesheet" TYPE="text/css"
	    HREF="../../../../css/jm-draft.css"/>
  <TITLE>Manpage of READPROFILE</TITLE>
</HEAD><BODY>
<H1>READPROFILE</H1>
Section: System Administration (8)<BR>Updated: October 2011<BR><A HREF="#index">Index</A>
<A HREF="https://github.com/ysatoautonomous/jm-draft/wiki">Return to Main Contents</A><HR>


<A NAME="lbAB">&nbsp;</A>
<H2>名前</H2>


readprofile - カーネルのプロファイル情報を読み込む。

<A NAME="lbAC">&nbsp;</A>
<H2>書式</H2>

<B>readprofile</B>

[options]

<A NAME="lbAD">&nbsp;</A>
<H2>バージョン</H2>


この man ページはプログラムのバージョン 2.0 についてドキュメント化している。

<A NAME="lbAE">&nbsp;</A>
<H2>説明</H2>

<P>












<B>readprofile</B>

コマンドは
<I>/proc/profile</I>

の情報を使い、ASCII データを標準出力に表示する。
出力は 3 列から構成される。
1 列目はクロックティック (clock ticks) 数、
2 列目はそのティックス数が発生したカーネルの C 言語の関数名、
3 列目はプロシージャの正規化した「負荷」の値であり、
ティックス数とプロシージャの長さの割合である。
出力は、読みやすいように、空白で埋められる。

<A NAME="lbAF">&nbsp;</A>
<H2>オプション</H2>

<DL COMPACT>
<DT><B>-a</B>, <B>--all</B><DD>


マップファイル内の全てのシンボルを表示する。
デフォルトでは、レポートされるティックスのプロシージャは
表示されない。
<DT><B>-b</B>, <B>--histbin</B><DD>

各ヒストグラムの区間のカウントを表示する。
<DT><B>-i</B>, <B>--info</B><DD>










情報。
このオプションを指定すると、
<B>readprofile</B>

はカーネルによって使われるプロファイリングステップのみを表示する。
プロファイリングステップは、プロファイリングバッファの精度であり、
(`make config' による) カーネル設定、またはカーネルのコマンドラインで選択される。
<B>-t</B>

(terse: 簡略) スイッチが
<B>-i</B>

とともに使われた場合、10 進数の値のみが表示される。
<DT><B>-m</B>, <B>--mapfile</B> <I>mapfile</I><DD>






マップファイルを指定する。
デフォルトは
<I>/usr/src/linux/System.map</I>

である。
現在のカーネルが最後にコンパイルしたものでない場合、
または System.map をどこか他の場所に置いている場合、
マップファイルをコマンドラインで指定すべきである。
マップファイル名が `.gz' で終わっている場合、自動で展開される。
<DT><B>-M</B>, <B>--multiplier</B> <I>multiplier</I><DD>






アーキテクチャによっては、カーネルが各 CPU で行うプロファイリング割り込みの
周期を変更することができる。
このオプションでは、割り込みの周期を、システムクロックの周波数の
倍数に設定できる (HZ)。
Linux 2.6.16 では多くのシステムで倍数のサポートをなくした。
このオプションはプロファイリングバッファのリセットも行い、
スーパーユーザー権限が必要である。
<DT><B>-p</B>, <B>--profile</B> <I>pro-file</I><DD>
Specify a different profiling buffer, which by default is
<I>/proc/profile</I>.

Using a different pro-file is useful if you want to `freeze' the
kernel profiling at some time and read it later.  The
<I>/proc/profile</I>

file can be copied using `cat' or `cp'.  There is no more support for
compressed profile buffers, like in
<B>readprofile-1.1,</B>

because the program needs to know the size of the buffer in advance.
<DT><B>-r</B>, <B>--reset</B><DD>
Reset the profiling buffer.  This can only be invoked by root,
because
<I>/proc/profile</I>

is readable by everybody but writable only by the superuser.
However, you can make
<B>readprofile</B>

set-user-ID 0, in order to reset the buffer without gaining privileges.
<DT><B>-s, --counters</B><DD>
Print individual counters within functions.
<DT><B>-v</B>, <B>--verbose</B><DD>
Verbose.  The output is organized in four columns and filled with
blanks.  The first column is the RAM address of a kernel function,
the second is the name of the function, the third is the number of
clock ticks and the last is the normalized load.
<DT><B>-V</B>, <B>--version</B><DD>
Display version information and exit.
<DT><B>-h</B>, <B>--help</B><DD>
Display help text and exit.
</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>EXAMPLES</H2>

Browse the profiling buffer ordering by clock ticks:
<PRE>
   readprofile | sort -nr | less

</PRE>

Print the 20 most loaded procedures:
<PRE>
   readprofile | sort -nr +2 | head -20

</PRE>

Print only filesystem profile:
<PRE>
   readprofile | grep _ext2

</PRE>

Look at all the kernel information, with ram addresses:
<PRE>
   readprofile -av | less

</PRE>

Browse a `frozen' profile buffer for a non current kernel:
<PRE>
   readprofile -p ~/profile.freeze -m /zImage.map.gz

</PRE>

Request profiling at 2kHz per CPU, and reset the profiling buffer:
<PRE>
   sudo readprofile -M 20
</PRE>

<A NAME="lbAH">&nbsp;</A>
<H2>BUGS</H2>

<P>

<B>readprofile</B>

only works with a 1.3.x or newer kernel, because
<I>/proc/profile</I>

changed in the step from 1.2 to 1.3
<P>

This program only works with ELF kernels.  The change for a.out
kernels is trivial, and left as an exercise to the a.out user.
<P>

To enable profiling, the kernel must be rebooted, because no
profiling module is available, and it wouldn't be easy to build.  To
enable profiling, you can specify &quot;profile=2&quot; (or another number) on
the kernel commandline.  The number you specify is the two-exponent
used as profiling step.
<P>

Profiling is disabled when interrupts are inhibited.  This means that
many profiling ticks happen when interrupts are re-enabled.  Watch
out for misleading information.
<A NAME="lbAI">&nbsp;</A>
<H2>FILES</H2>

<PRE>
/proc/profile              A binary snapshot of the profiling buffer.
/usr/src/linux/System.map  The symbol table for the kernel.
/usr/src/linux/*           The program being profiled :-)
</PRE>

<A NAME="lbAJ">&nbsp;</A>
<H2>AVAILABILITY</H2>

The readprofile command is part of the util-linux package and is
available from

Linux Kernel Archive

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">名前</A><DD>
<DT><A HREF="#lbAC">書式</A><DD>
<DT><A HREF="#lbAD">バージョン</A><DD>
<DT><A HREF="#lbAE">説明</A><DD>
<DT><A HREF="#lbAF">オプション</A><DD>
<DT><A HREF="#lbAG">EXAMPLES</A><DD>
<DT><A HREF="#lbAH">BUGS</A><DD>
<DT><A HREF="#lbAI">FILES</A><DD>
<DT><A HREF="#lbAJ">AVAILABILITY</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 17:00:00 GMT, April 27, 2020
</BODY>
</HTML>

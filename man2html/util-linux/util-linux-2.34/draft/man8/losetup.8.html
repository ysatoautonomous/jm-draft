<HTML>
  <HEAD>
  <META CHARSET="UTF-8"/>
  <META HTTP-QUIV="Content-Type" CONTENT="text/html; charset=UTF-8"/>
  <LINK REL="stylesheet" TYPE="text/css"
	    HREF="../../../../css/jm-draft.css"/>
  <TITLE>Manpage of LOSETUP</TITLE>
</HEAD><BODY>
<H1>LOSETUP</H1>
Section: System Administration (8)<BR>Updated: November 2015<BR><A HREF="#index">Index</A>
<A HREF="https://github.com/ysatoautonomous/jm-draft/wiki">Return to Main Contents</A><HR>


<A NAME="lbAB">&nbsp;</A>
<H2>名前</H2>


losetup - loop デバイスの設定と制御を行う

<A NAME="lbAC">&nbsp;</A>
<H2>書式</H2>



情報を取得する:
<P>

<B>losetup</B>

[<I>loopdev</I>]
<P>
<B>losetup -l</B>

[<B>-a</B>]

<P>
<B>losetup -j</B>

<I>file</I>

[<B>-o</B>

<I>offset</I>]

<P>


loop デバイスを切断する:
<P>

<B>losetup -d</B>

<I>loopdev</I>...

<P>


紐付けられた全ての loop デバイスを切断する:
<P>

<B>losetup -D</B>

<P>


loop デバイスを設定する:
<P>

<B>losetup</B>

[<B>-o</B>

<I>offset</I>]

[<B>--sizelimit</B>

<I>size</I>]

[<B>--sector-size</B>

<I>size</I>]


[<B>-Pr</B>]

[<B>--show</B>]<B> -f</B>|<B></B><I>loopdev</I>

<I>file</I>

<P>


loop デバイスをリサイズする:
<P>

<B>losetup -c</B>

<I>loopdev</I>




<A NAME="lbAD">&nbsp;</A>
<H2>説明</H2>






<B>losetup</B>

は loop デバイスを通常のファイルやブロックデバイスと接続/切断したり、
loop デバイスへの問い合わせを行うために用いられる。
引き数として
<I>loop_device</I>

が与えられた場合に限り、対応する loop デバイスの状態が表示される。
オプションが指定されない場合、全ての loop デバイスが表示される。
<P>


古い出力フォーマット (つまり、<B>losetup -a</B>) の
コンマ区切り文字列は廃れており、
<B>--list</B> 出力フォーマットが指示されている。
<P>




同じバッキングファイルで、より独立性の高い loop デバイスを作ることができる。
<B>このセットアップは危険であり、データの喪失・破損・上書きを</B>

<B>引き起こす場合がある。</B>

この問題を避けるには、セットアップ時に
<B>--nooverlap</B> と <B>--find</B> を使うこと。

<A NAME="lbAE">&nbsp;</A>
<H2>オプション</H2>






<I>size</I> と <I>offset</I>
引き数をバイトではなく、数値と倍数のサフィックス KiB (=1024), MiB (=1024*1024),
さらに GiB, TiB, PiB, EiB, ZiB, YiB を続けて指定できる。
(&quot;iB&quot; はオプションであり、例えば &quot;K&quot; は &quot;KiB&quot; と同じ意味である)。
もしくはサフィックス KB (=1000), MB (=1000*1000),
さらに GB, TB, PB, EB, ZB, YB を続けて指定できる。
<DL COMPACT>
<DT><B>-a</B>,<B> --all</B>

<DD>



全ての loop デバイスの状態を表示する。
非 root ユーザでは全ての情報にアクセスできる訳ではない点に注意すること。
<B>--list</B> を参照すること。
(<B>--list</B> を指定せずに表示される) 古いフォーマットは廃れている。
<DT><B>-d</B>,<B> --detach </B><I>loopdev</I>...

<DD>




指定した loop デバイスを対応するファイルやデバイスから切断する。
Linux v3.7 カーネルから「遅延デバイス破棄」を使っている点に注意すること。
デバイスがシステムにアクティブに使用されている場合でも、
切断操作は最早 EBUSY エラーを返さなくなり、
自動クリア (autoclear) フラグでマークされ、後から破棄される。
<DT><B>-D</B>,<B> --detach-all</B>

<DD>

紐付けられた全ての loop デバイスを切断する。
<DT><B>-f</B>,<B> --find </B>[<I>file</I>]

<DD>


使用されていない最初の loop デバイスを見つける。
<I>file</I> 引き数が指定されている場合は、そのデバイスを loop デバイスとして使用する。
指定されていない場合は、loop デバイスの名前を表示する。
<DT><B>--show</B><DD>


<B>-f</B> オプションと <I>file</I> 引き数が指定されている場合、
紐付けられた loop デバイスの名前を表示する。
<DT><B>-L</B>,<B> --nooverlap</B>

<DD>




同じバッキングファイルが複数の loop デバイスで共有されている状況を避けるため、
loop デバイス間の衝突をチェックする。
ファイルが他のデバイスで既に使われている場合、
新しいデバイスを作るのではなく、そのデバイスを再利用する。
このオプションは <B>--find</B> と一緒に指定された場合にのみ意味を持つ。
<DT><B>-j</B>,<B> --associated </B><I>file</I><B> </B>[<B>-o </B><I>offset</I>]

<DD>

指定された <I>file</I> に紐付けられた全ての loop デバイスの状態を表示する。
<DT><B>-o</B>,<B> --offset </B><I>offset</I>

<DD>


データの開始地点を指定したファイルやデバイスの <I>offset</I> バイトに移動する。
<I>offset</I> は、上記の乗数のサフィックスを付けることができる。
<DT><B>--sizelimit </B><I>size</I><DD>


データの終了地点を、データの開始地点から <I>size</I> バイトにする。
<I>size</I> は、上記の乗数のサフィックスを付けることができる。
<DT><B>-b</B>,<B> --sector-size </B><I>size</I>

<DD>



loop デバイスの論理セクタサイズを指定したバイトにする (Linux 4.14 以降)。
このオプションは、新しい loop デバイスを作成するときにも、
既存の loop デバイスのセクタサイズを変更するときのスタンドアロンの
コマンドにも使える。
<DT><B>-c</B>,<B> --set-capacity </B><I>loopdev</I>

<DD>


指定された loop デバイスに紐付けられたファイルのサイズを、
loop ドライバに再読み込みさせる。
<DT><B>-P</B>,<B> --partscan</B>

<DD>



新しく作成された loop デバイスのパーティションテーブルを
カーネルにスキャンさせる。
パーティションテーブルの解析は、セクタサイズに依存する点に
注意すること。
デフォルトのセクタサイズは 512 バイトである。
それ以外の値を使いたい場合は、オプション <B>--sector-size</B> を
<B>--partscan</B> とともに指定すること。
<DT><B>-r</B>,<B> --read-only</B>

<DD>

読み込みのみの loop デバイスを設定する。
<DT><B>--direct-io</B>[<B>=on</B>|<B>off</B>]

<DD>



バッキングファイルの直接 I/O を有効または無効にする。
オプションの引き数は <B>on</B> または <B>off</B> のいずれかである。
引き数が省略された場合、デフォルトは <B>on</B> である。
<DT><B>-v</B>,<B> --verbose</B>

<DD>

詳細なモード。
<DT><B>-l</B>,<B> --list</B>

<DD>




loop デバイス、または <B>-a</B> オプションが指定された場合、
指定された loop デバイス、または全てのデバイスの
デフォルトの列が表示される。
デフォルトでは全てのデバイスの情報を表示する。
<B>--output</B>, <B>--noheadings</B>,
<B>--raw</B>, <B>--json</B> を参照すること。
<DT><B>-O</B>,<B> --output </B><I>column</I>[,<I>column</I>]...

<DD>


<B>--list</B> 出力で表示される列を指定する。
サポートされる全ての列のリストを取得するには、<B>--help</B> を使うこと。
<DT><B>--output-all</B>

<DD>

利用可能な全ての列を出力する。
<DT><B>-n</B>,<B> --noheadings</B>

<DD>

<B>--list</B> 出力フォーマットで、ヘッダを表示しない。
<DT><B>--raw</B><DD>

生の <B>--list</B> 出力フォーマットを使う。
<DT><B>-J</B>,<B> --json</B>

<DD>

<B>--list</B> 出力で JSON フォーマットを使う。
<DT><B>-V</B>,<B> --version</B>

<DD>

バージョン情報を表示して、終了する。
<DT><B>-h</B>,<B> --help</B>

<DD>

ヘルプを表示して、終了する。
<P>

</DL>
<A NAME="lbAF">&nbsp;</A>
<H2>暗号化</H2>



<B>cryptoloop は既にサポートされておらず、dm-crypt が支持されている。</B>

<B>より詳細は <A HREF="../man8/cryptsetup.8.html">cryptsetup</A>(8) を参照すること。</B>

<P>

<A NAME="lbAG">&nbsp;</A>
<H2>返り値</H2>








<B>losetup</B>

は成功すると 0 を返し、失敗すると 0 以外を返す。
<B>losetup</B>

に loop デバイスの状態を表示させる場合は、
デバイスが設定されていなければ 1 を、
デバイスの状態を決定できなくするようなエラーが起った場合は 2 を返す。
<P>

<A NAME="lbAH">&nbsp;</A>
<H2>ファイル</H2>

<DL COMPACT>
<DT><I>/dev/loop[0..N]</I>

<DD>

loop ブロックデバイス
<DT><I>/dev/loop-control</I>

<DD>

loop コントロールデバイス
<P>

</DL>
<A NAME="lbAI">&nbsp;</A>
<H2>例</H2>


以下の一連のコマンドは loop デバイスの使用例である。
<PRE>
<DL COMPACT>
<DT><DD># dd if=/dev/zero of=~/file.img bs=1024k count=10
# losetup --find --show ~/file.img
/dev/loop0
# mkfs -t ext2 /dev/loop0
# mount /dev/loop0 /mnt
# umount /dev/loop0
# losetup --detach /dev/loop0
</PRE>


</DL>
<A NAME="lbAJ">&nbsp;</A>
<H2>環境変数</H2>

<DL COMPACT>
<DT>LOOPDEV_DEBUG=all<DD>

デバッグ出力を有効にする。

</DL>
<A NAME="lbAK">&nbsp;</A>
<H2>作者</H2>



Karel Zak &lt;<A HREF="mailto:kzak@redhat.com">kzak@redhat.com</A>&gt; が
Theodore Ts'o &lt;<A HREF="mailto:tytso@athena.mit.edu">tytso@athena.mit.edu</A>&gt; の
オリジナルバージョンに基づいて書いた。

<A NAME="lbAL">&nbsp;</A>
<H2>入手方法</H2>



losetup コマンドは util-linux パッケージの一部であり、
<A HREF="https://www.kernel.org/pub/linux/utils/util-linux/">https://www.kernel.org/pub/linux/utils/util-linux/</A>
から入手できる。
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">名前</A><DD>
<DT><A HREF="#lbAC">書式</A><DD>
<DT><A HREF="#lbAD">説明</A><DD>
<DT><A HREF="#lbAE">オプション</A><DD>
<DT><A HREF="#lbAF">暗号化</A><DD>
<DT><A HREF="#lbAG">返り値</A><DD>
<DT><A HREF="#lbAH">ファイル</A><DD>
<DT><A HREF="#lbAI">例</A><DD>
<DT><A HREF="#lbAJ">環境変数</A><DD>
<DT><A HREF="#lbAK">作者</A><DD>
<DT><A HREF="#lbAL">入手方法</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 17:05:43 GMT, March 22, 2020
</BODY>
</HTML>
